<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8">
    <title>Dati Ordinabili da CSV</title>
    <script src="https://d3js.org/d3.v6.min.js"></script>
    <script>
      d3.csv("dati.csv").then(function(data) {
        var table = d3.select("#data-table");
        var rows = table.selectAll("tr").data(data).enter().append("tr");
        rows.append("td").text(function(d) { return d.Nome; });
        rows.append("td").text(function(d) { return d["Utilizzo (%)"]; });
      });
      
      function sortByUsage() {
        var table = document.getElementById("data-table");
        var rows = table.rows;
        var data = [];
        for (var i = 1; i < rows.length; i++) {
          var name = rows[i].cells[0].innerText;
          var usage = parseFloat(rows[i].cells[1].innerText);
          data.push([name, usage]);
        }
        data.sort(function(a, b) {
          return b[1] - a[1];
        });
        for (var i = 0; i < data.length; i++) {
          rows[i+1].cells[0].innerText = data[i][0];
          rows[i+1].cells[1].innerText = data[i][1].toFixed(2);
        }
      }
      
      function sortByName() {
        var table = document.getElementById("data-table");
        var rows = table.rows;
        var data = [];
        for (var i = 1; i < rows.length; i++) {
          var name = rows[i].cells[0].innerText;
          var usage = parseFloat(rows[i].cells[1].innerText);
          data.push([name, usage]);
        }
        data.sort(function(a, b) {
          return a[0].localeCompare(b[0]);
        });
        for (var i = 0; i < data.length; i++) {
          rows[i+1].cells[0].innerText = data[i][0];
          rows[i+1].cells[1].innerText = data[i][1].toFixed(2);
        }
      }
    </script>
  </head>
  <body>
    <table id="data-table">
      <tr>
        <th>Nome</th>
        <th>Utilizzo (%)</th>
      </tr>
    </table>
    <br>
    <button onclick="sortByUsage()">Ordina per Utilizzo</button>
    <button onclick="sortByName()">Ordina per Nome</button>
  </body>
</html>